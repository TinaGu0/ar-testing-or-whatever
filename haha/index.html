<!DOCTYPE html>
<html>
  <head>
    <title>AR.js with Custom Model</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/ar.js/master/aframe/build/aframe-ar.js"></script>
    <script src="what.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene 
    embedded 
    arjs='sourceType: webcam;'
    renderer="logarithmicDepthBuffer: true;"
    vr-mode-ui="enabled: false"
    gesture-detector
    id="scene">
      <a-marker preset='hiro'>
        <a-nft
        type="nft"
        url="url(/public/sky.glb)"
        smooth="true"
        smoothCount="10"
        smoothTolerance=".01"
        smoothThreshold="5"
        raycaster="objects: .clickable"
        emitevents="true"
        cursor="fuse: false; rayOrigin: mouse;"
      >
        <a-entity
          gltf-model="url(/public/sky.glb)"
          scale="0.5 0.5 0.5"
          position="0 0 0"
          class="clickable"
          gesture-handler="minScale: 0.25; maxScale:10"
        ></a-entity>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
<!--     <script src="huh.js"></script> -->
  </body>
</html>

<script>
  let sceneEl = document.querySelector('a-scene');

sceneEl.addEventListener("onefingermove", one());
sceneEl.addEventListener("twofingermove", two());

sceneEl.addEventListener("markerFound", (e) => {
    isMarkerVisible = true;
});

sceneEl.addEventListener("markerLost", (e) => {
    isMarkerVisible = false;
});

function one(event) {
  if(isMarkerVisible) [
    el.object3D.rotation.y += 
    event.detail.positionChange.x * rotationFactor,

    el.object3D.rotation.x +=
    event.detail.positionChange.y * rotationFactor
  ]
}

function two(event) {
  if (isMarkerVisible) {
      this.scaleFactor *=
        1 + event.detail.spreadChange / event.detail.startSpread;

      this.scaleFactor = Math.min(
        Math.max(this.scaleFactor, this.data.minScale),
        this.data.maxScale
      );

      el.object3D.scale.x = scaleFactor * initialScale.x;
      el.object3D.scale.y = scaleFactor * initialScale.y;
      el.object3D.scale.z = scaleFactor * initialScale.z;
    }
}
</script>
